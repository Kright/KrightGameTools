// Copyright (c) 2025 Igor Slobodskov
// SPDX-License-Identifier: MIT

#pragma once

#include "types.h"

// generated by com.github.kright.pga3d.codegen.cpp.ops.SandwichOpGenerator

/**
 * Compiler can reuse constants between calls, where the same object used several times,
 * So in the code below all that constants `const double sMs = s * s` are reused and the code is fast.
 * It is crucial to keep method constexpr or inline to achieve this
 * On my machine this trick speed up `Motor.sandwich(Bivector)` from 9 ns to 3 ns
 * @code
 * const pga3d::Motor& motor = ...
 * for(pga3d::Vector& v: array) {
 *     v = motor.sandwich(v);
 * }
 * @endcode
 */
namespace pga3d {
    [[nodiscard]] constexpr Multivector sandwich(const Multivector&a, const Multivector& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMw = a.s * a.w;
        const double sMx = a.s * a.x;
        const double sMy = a.s * a.y;
        const double sMz = a.s * a.z;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double sMwxy = a.s * a.wxy;
        const double sMwxz = a.s * a.wxz;
        const double sMwyz = a.s * a.wyz;
        const double sMxyz = a.s * a.xyz;
        const double sMi = a.i * a.s;
        const double wMx = a.w * a.x;
        const double wMy = a.w * a.y;
        const double wMz = a.w * a.z;
        const double wMxy = a.w * a.xy;
        const double wMxz = a.w * a.xz;
        const double wMyz = a.w * a.yz;
        const double wMxyz = a.w * a.xyz;
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double xMwx = a.wx * a.x;
        const double xMwy = a.wy * a.x;
        const double xMwz = a.wz * a.x;
        const double xMxy = a.x * a.xy;
        const double xMxz = a.x * a.xz;
        const double xMyz = a.x * a.yz;
        const double xMwxy = a.wxy * a.x;
        const double xMwxz = a.wxz * a.x;
        const double xMwyz = a.wyz * a.x;
        const double xMxyz = a.x * a.xyz;
        const double xMi = a.i * a.x;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double yMwx = a.wx * a.y;
        const double yMwy = a.wy * a.y;
        const double yMwz = a.wz * a.y;
        const double yMxy = a.xy * a.y;
        const double yMxz = a.xz * a.y;
        const double yMyz = a.y * a.yz;
        const double yMwxy = a.wxy * a.y;
        const double yMwxz = a.wxz * a.y;
        const double yMwyz = a.wyz * a.y;
        const double yMxyz = a.xyz * a.y;
        const double yMi = a.i * a.y;
        const double zMz = a.z * a.z;
        const double zMwx = a.wx * a.z;
        const double zMwy = a.wy * a.z;
        const double zMwz = a.wz * a.z;
        const double zMxy = a.xy * a.z;
        const double zMxz = a.xz * a.z;
        const double zMyz = a.yz * a.z;
        const double zMwxy = a.wxy * a.z;
        const double zMwxz = a.wxz * a.z;
        const double zMwyz = a.wyz * a.z;
        const double zMxyz = a.xyz * a.z;
        const double zMi = a.i * a.z;
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wxMxyz = a.wx * a.xyz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wyMxyz = a.wy * a.xyz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double wzMxyz = a.wz * a.xyz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xyMwxy = a.wxy * a.xy;
        const double xyMwxz = a.wxz * a.xy;
        const double xyMwyz = a.wyz * a.xy;
        const double xyMxyz = a.xy * a.xyz;
        const double xyMi = a.i * a.xy;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double xzMwxy = a.wxy * a.xz;
        const double xzMwxz = a.wxz * a.xz;
        const double xzMwyz = a.wyz * a.xz;
        const double xzMxyz = a.xyz * a.xz;
        const double xzMi = a.i * a.xz;
        const double yzMyz = a.yz * a.yz;
        const double yzMwxy = a.wxy * a.yz;
        const double yzMwxz = a.wxz * a.yz;
        const double yzMwyz = a.wyz * a.yz;
        const double yzMxyz = a.xyz * a.yz;
        const double yzMi = a.i * a.yz;
        const double wxyMxyz = a.wxy * a.xyz;
        const double wxzMxyz = a.wxz * a.xyz;
        const double wyzMxyz = a.wyz * a.xyz;
        const double xyzMxyz = a.xyz * a.xyz;
        const double xyzMi = a.i * a.xyz;
        return {
            .s = (2.0 * (b.x * (sMx + yzMxyz - yMxy - zMxz) + b.y * (sMy + xMxy - xzMxyz - zMyz) + b.z * (sMz + xMxz + xyMxyz + yMyz)) + b.s * (sMs + xMx + xyMxy + xyzMxyz + xzMxz + yMy + yzMyz + zMz)),
            .w = (2.0 * (b.i * (sMxyz + yMxz - xMyz - zMxy) + b.s * (sMw + xMwx + xyMwxy + xyzMi + xzMwxz + yMwy + yzMwyz + zMwz) + b.x * (sMwx + wMx + wyzMxyz + yzMi - wyMxy - wzMxz - yMwxy - zMwxz) + b.y * (sMwy + wMy + wxMxy + xMwxy - wxzMxyz - wzMyz - xzMi - zMwyz) + b.z * (sMwz + wMz + wxMxz + wxyMxyz + wyMyz + xMwxz + xyMi + yMwyz)) + b.w * (sMs + xyMxy + xzMxz + yzMyz - xMx - xyzMxyz - yMy - zMz)),
            .x = (2.0 * (b.s * (sMx + yMxy + yzMxyz + zMxz) + b.y * (sMxy + xMy - xzMyz - zMxyz) + b.z * (sMxz + xMz + xyMyz + yMxyz)) + b.x * (sMs + xMx + xyzMxyz + yzMyz - xyMxy - xzMxz - yMy - zMz)),
            .y = (2.0 * (b.s * (sMy + zMyz - xMxy - xzMxyz) + b.x * (xMy + zMxyz - sMxy - xzMyz) + b.z * (sMyz + yMz - xMxyz - xyMxz)) + b.y * (sMs + xyzMxyz + xzMxz + yMy - xMx - xyMxy - yzMyz - zMz)),
            .z = (2.0 * (b.s * (sMz + xyMxyz - xMxz - yMyz) + b.x * (xMz + xyMyz - sMxz - yMxyz) + b.y * (xMxyz + yMz - sMyz - xyMxz)) + b.z * (sMs + xyMxy + xyzMxyz + zMz - xMx - xzMxz - yMy - yzMyz)),
            .wx = (2.0 * (b.wxy * (sMy + xzMxyz - xMxy - zMyz) + b.wxz * (sMz + yMyz - xMxz - xyMxyz) + b.wy * (sMxy + zMxyz - xMy - xzMyz) + b.wyz * (sMxyz + zMxy - xMyz - yMxz) + b.wz * (sMxz + xyMyz - xMz - yMxyz) + b.xy * (wMy + wxMxy + wxzMxyz + wzMyz - sMwy - xMwxy - xzMi - zMwyz) + b.xyz * (wMyz + wxMxyz + xyMwxz + yMwz - sMwyz - xMi - xzMwxy - zMwy) + b.xz * (wMz + wxMxz + xyMi + yMwyz - sMwz - wxyMxyz - wyMyz - xMwxz) + b.yz * (wMxyz + wxMyz + wyMxz + zMwxy - sMi - wzMxy - xMwyz - yMwxz)) + b.wx * (sMs + yMy + yzMyz + zMz - xMx - xyMxy - xyzMxyz - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xMy - xzMyz - zMxyz) + b.wxy * (yzMxyz + zMxz - sMx - yMxy) + b.wxz * (-sMxyz - xMyz - yMxz - zMxy) + b.wyz * (sMz + xMxz - xyMxyz - yMyz) + b.wz * (sMyz + xMxyz - xyMxz - yMz) + b.xy * (sMwx + wyMxy + wyzMxyz + zMwxz - wMx - wzMxz - yMwxy - yzMi) + b.xyz * (sMwxz + wyMxyz + xyMwyz + zMwx - wMxz - xMwz - yMi - yzMwxy) + b.xz * (sMi + wxMyz + wyMxz + wzMxy - wMxyz - xMwyz - yMwxz - zMwxy) + b.yz * (wMz + wyMyz + xMwxz + xyMi - sMwz - wxMxz - wxyMxyz - yMwyz)) + b.wy * (sMs + xMx + xzMxz + zMz - xyMxy - xyzMxyz - yMy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz + yMxyz - sMxz - xMz) + b.wxy * (sMxyz + xMyz - yMxz - zMxy) + b.wxz * (yMxy + yzMxyz - sMx - zMxz) + b.wy * (-sMyz - xMxyz - xyMxz - yMz) + b.wyz * (-sMy - xMxy - xzMxyz - zMyz) + b.xy * (wMxyz + wyMxz + wzMxy + xMwyz - sMi - wxMyz - yMwxz - zMwxy) + b.xyz * (wMxy + wzMxyz + xMwy + xzMwyz - sMwxy - yMwx - yzMwxz - zMi) + b.xz * (sMwx + wyzMxyz + wzMxz + yMwxy - wMx - wyMxy - yzMi - zMwxz) + b.yz * (sMwy + wxMxy + wzMyz + xzMi - wMy - wxzMxyz - xMwxy - zMwyz)) + b.wz * (sMs + xMx + xyMxy + yMy - xyzMxyz - xzMxz - yzMyz - zMz)),
            .xy = (2.0 * (b.xyz * (sMz + xyMxyz - xMxz - yMyz) + b.xz * (sMyz + xyMxz - xMxyz - yMz) + b.yz * (xMz + xyMyz - sMxz - yMxyz)) + b.xy * (sMs + xyMxy + xyzMxyz + zMz - xMx - xzMxz - yMy - yzMyz)),
            .xz = (2.0 * (b.xy * (xMxyz + xyMxz - sMyz - yMz) + b.xyz * (xMxy + xzMxyz - sMy - zMyz) + b.yz * (sMxy + xzMyz - xMy - zMxyz)) + b.xz * (sMs + xyzMxyz + xzMxz + yMy - xMx - xyMxy - yzMyz - zMz)),
            .yz = (2.0 * (b.xy * (sMxz + xMz + xyMyz + yMxyz) + b.xyz * (sMx + yMxy + yzMxyz + zMxz) + b.xz * (xzMyz + zMxyz - sMxy - xMy)) + b.yz * (sMs + xMx + xyzMxyz + yzMyz - xyMxy - xzMxz - yMy - zMz)),
            .wxy = (2.0 * (b.wx * (sMy + xMxy + xzMxyz + zMyz) + b.wxz * (sMyz + xMxyz + xyMxz + yMz) + b.wy * (yMxy + yzMxyz - sMx - zMxz) + b.wyz * (xyMyz + yMxyz - sMxz - xMz) + b.wz * (yMxz + zMxy - sMxyz - xMyz) + b.xy * (sMw + xyMwxy + xyzMi + zMwz - xMwx - xzMwxz - yMwy - yzMwyz) + b.xyz * (sMwz + wMz + wxyMxyz + xyMi - wxMxz - wyMyz - xMwxz - yMwyz) + b.xz * (sMwyz + wMyz + xyMwxz + xzMwxy - wxMxyz - xMi - yMwz - zMwy) + b.yz * (xMwz + xyMwyz + yzMwxy + zMwx - sMwxz - wMxz - wyMxyz - yMi)) + b.wxy * (sMs + xMx + xyMxy + yMy - xyzMxyz - xzMxz - yzMyz - zMz)),
            .wxz = (2.0 * (b.wx * (sMz + xMxz - xyMxyz - yMyz) + b.wxy * (xyMxz + yMz - sMyz - xMxyz) + b.wy * (sMxyz + xMyz + yMxz + zMxy) + b.wyz * (sMxy + xMy + xzMyz + zMxyz) + b.wz * (yzMxyz + zMxz - sMx - yMxy) + b.xy * (wxMxyz + xMi + xyMwxz + xzMwxy - sMwyz - wMyz - yMwz - zMwy) + b.xyz * (wxMxy + wxzMxyz + xMwxy + xzMi - sMwy - wMy - wzMyz - zMwyz) + b.xz * (sMw + xyzMi + xzMwxz + yMwy - xMwx - xyMwxy - yzMwyz - zMwz) + b.yz * (sMwxy + wMxy + xzMwyz + yzMwxz - wzMxyz - xMwy - yMwx - zMi)) + b.wxz * (sMs + xMx + xzMxz + zMz - xyMxy - xyzMxyz - yMy - yzMyz)),
            .wyz = (2.0 * (b.wx * (xMyz + yMxz - sMxyz - zMxy) + b.wxy * (sMxz + xyMyz - xMz - yMxyz) + b.wxz * (xMy + xzMyz - sMxy - zMxyz) + b.wy * (sMz + yMyz - xMxz - xyMxyz) + b.wz * (xMxy + zMyz - sMy - xzMxyz) + b.xy * (sMwxz + wMxz + wyMxyz + xMwz + xyMwyz + yMi + yzMwxy + zMwx) + b.xyz * (sMwx + wMx + wyMxy + wyzMxyz + wzMxz + yMwxy + yzMi + zMwxz) + b.xz * (wzMxyz + xzMwyz + yzMwxz + zMi - sMwxy - wMxy - xMwy - yMwx) + b.yz * (sMw + xMwx + xyzMi + yzMwyz - xyMwxy - xzMwxz - yMwy - zMwz)) + b.wyz * (sMs + yMy + yzMyz + zMz - xMx - xyMxy - xyzMxyz - xzMxz)),
            .xyz = (2.0 * (b.xy * (sMz + xMxz + xyMxyz + yMyz) + b.xz * (xzMxyz + zMyz - sMy - xMxy) + b.yz * (sMx + yzMxyz - yMxy - zMxz)) + b.xyz * (sMs + xMx + xyMxy + xyzMxyz + xzMxz + yMy + yzMyz + zMz)),
            .i = (2.0 * (b.s * (sMi + wyMxz + xMwyz + zMwxy - wMxyz - wxMyz - wzMxy - yMwxz) + b.w * (xMyz + zMxy - sMxyz - yMxz) + b.x * (sMwyz + xMi + xyMwxz + yMwz - wMyz - wxMxyz - xzMwxy - zMwy) + b.y * (wMxz + xyMwyz + yMi + zMwx - sMwxz - wyMxyz - xMwz - yzMwxy) + b.z * (sMwxy + xMwy + xzMwyz + zMi - wMxy - wzMxyz - yMwx - yzMwxz)) + b.i * (sMs + xyMxy + xzMxz + yzMyz - xMx - xyzMxyz - yMy - zMz))
        };
    }
    constexpr Multivector Multivector::sandwich(const Multivector& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const Motor&a, const Motor& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double sMi = a.i * a.s;
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xyMi = a.i * a.xy;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double xzMi = a.i * a.xz;
        const double yzMyz = a.yz * a.yz;
        const double yzMi = a.i * a.yz;
        return {
            .s = b.s * (sMs + xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz) + b.xy * (wxMxy + wzMyz - sMwy - xzMi) + b.xz * (wxMxz + xyMi - sMwz - wyMyz) + b.yz * (wxMyz + wyMxz - sMi - wzMxy)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz) + b.xy * (sMwx + wyMxy - wzMxz - yzMi) + b.xz * (sMi + wxMyz + wyMxz + wzMxy) + b.yz * (wyMyz + xyMi - sMwz - wxMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz) + b.xy * (wyMxz + wzMxy - sMi - wxMyz) + b.xz * (sMwx + wzMxz - wyMxy - yzMi) + b.yz * (sMwy + wxMxy + wzMyz + xzMi)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz)),
            .xy = (2.0 * (b.xz * (sMyz + xyMxz) + b.yz * (xyMyz - sMxz)) + b.xy * (sMs + xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * (xyMxz - sMyz) + b.yz * (sMxy + xzMyz)) + b.xz * (sMs + xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * (sMxz + xyMyz) + b.xz * (xzMyz - sMxy)) + b.yz * (sMs + yzMyz - xyMxy - xzMxz)),
            .i = (b.i * (sMs + xyMxy + xzMxz + yzMyz) + 2.0 * b.s * (sMi + wyMxz - wxMyz - wzMxy))
        };
    }
    constexpr Motor Motor::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Motor&a, const Plane& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz)),
            .w = (2.0 * (b.x * (a.i * a.yz + a.s * a.wx - a.wy * a.xy - a.wz * a.xz) + b.y * (a.s * a.wy + a.wx * a.xy - a.i * a.xz - a.wz * a.yz) + b.z * (a.i * a.xy + a.s * a.wz + a.wx * a.xz + a.wy * a.yz)) + b.w * (sMs + xyMxy + xzMxz + yzMyz))
        };
    }
    constexpr Plane Motor::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Motor&a, const Bivector& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double sMi = a.i * a.s;
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xyMi = a.i * a.xy;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double xzMi = a.i * a.xz;
        const double yzMyz = a.yz * a.yz;
        const double yzMi = a.i * a.yz;
        return {
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz) + b.xy * (wxMxy + wzMyz - sMwy - xzMi) + b.xz * (wxMxz + xyMi - sMwz - wyMyz) + b.yz * (wxMyz + wyMxz - sMi - wzMxy)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz) + b.xy * (sMwx + wyMxy - wzMxz - yzMi) + b.xz * (sMi + wxMyz + wyMxz + wzMxy) + b.yz * (wyMyz + xyMi - sMwz - wxMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz) + b.xy * (wyMxz + wzMxy - sMi - wxMyz) + b.xz * (sMwx + wzMxz - wyMxy - yzMi) + b.yz * (sMwy + wxMxy + wzMyz + xzMi)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz)),
            .xy = (2.0 * (b.xz * (sMyz + xyMxz) + b.yz * (xyMyz - sMxz)) + b.xy * (sMs + xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * (xyMxz - sMyz) + b.yz * (sMxy + xzMyz)) + b.xz * (sMs + xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * (sMxz + xyMyz) + b.xz * (xzMyz - sMxy)) + b.yz * (sMs + yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr Bivector Motor::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Motor&a, const ProjectivePoint& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.w * (-a.i * a.yz - a.s * a.wx - a.wy * a.xy - a.wz * a.xz) + b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.w * (a.i * a.xz + a.wx * a.xy - a.s * a.wy - a.wz * a.yz) + b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.w * (a.wx * a.xz + a.wy * a.yz - a.i * a.xy - a.s * a.wz) + b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz)),
            .w = b.w * (sMs + xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr ProjectivePoint Motor::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Motor&a, const Quaternion& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double sMi = a.i * a.s;
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xyMi = a.i * a.xy;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double xzMi = a.i * a.xz;
        const double yzMyz = a.yz * a.yz;
        const double yzMi = a.i * a.yz;
        return {
            .s = b.s * (sMs + xyMxy + xzMxz + yzMyz),
            .wx = 2.0 * (b.xy * (wxMxy + wzMyz - sMwy - xzMi) + b.xz * (wxMxz + xyMi - sMwz - wyMyz) + b.yz * (wxMyz + wyMxz - sMi - wzMxy)),
            .wy = 2.0 * (b.xy * (sMwx + wyMxy - wzMxz - yzMi) + b.xz * (sMi + wxMyz + wyMxz + wzMxy) + b.yz * (wyMyz + xyMi - sMwz - wxMxz)),
            .wz = 2.0 * (b.xy * (wyMxz + wzMxy - sMi - wxMyz) + b.xz * (sMwx + wzMxz - wyMxy - yzMi) + b.yz * (sMwy + wxMxy + wzMyz + xzMi)),
            .xy = (2.0 * (b.xz * (sMyz + xyMxz) + b.yz * (xyMyz - sMxz)) + b.xy * (sMs + xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * (xyMxz - sMyz) + b.yz * (sMxy + xzMyz)) + b.xz * (sMs + xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * (sMxz + xyMyz) + b.xz * (xzMyz - sMxy)) + b.yz * (sMs + yzMyz - xyMxy - xzMxz)),
            .i = 2.0 * b.s * (sMi + wyMxz - wxMyz - wzMxy)
        };
    }
    constexpr Motor Motor::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Motor&a, const ProjectiveTranslator& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (sMs + xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz)),
            .xy = 0.0,
            .xz = 0.0,
            .yz = 0.0,
            .i = 2.0 * b.s * (a.i * a.s + a.wy * a.xz - a.wx * a.yz - a.wz * a.xy)
        };
    }
    constexpr Motor Motor::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Motor&a, const Translator& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = (sMs + xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz)),
            .xy = 0.0,
            .xz = 0.0,
            .yz = 0.0,
            .i = 2.0 * (a.i * a.s + a.wy * a.xz - a.wx * a.yz - a.wz * a.xy)
        };
    }
    constexpr Motor Motor::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const Motor&a, const Vector& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr Vector Motor::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Motor&a, const Point& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz) - a.i * a.yz - a.s * a.wx - a.wy * a.xy - a.wz * a.xz) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (a.i * a.xz + a.wx * a.xy + b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz) - a.s * a.wy - a.wz * a.yz) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (a.wx * a.xz + a.wy * a.yz + b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz) - a.i * a.xy - a.s * a.wz) + b.z * (sMs + xyMxy - xzMxz - yzMyz)),
            .w = (sMs + xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr ProjectivePoint Motor::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Motor&a, const PlaneIdeal& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz)),
            .w = 2.0 * (b.x * (a.i * a.yz + a.s * a.wx - a.wy * a.xy - a.wz * a.xz) + b.y * (a.s * a.wy + a.wx * a.xy - a.i * a.xz - a.wz * a.yz) + b.z * (a.i * a.xy + a.s * a.wz + a.wx * a.xz + a.wy * a.yz))
        };
    }
    constexpr Plane Motor::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Motor&a, const BivectorBulk& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double sMi = a.i * a.s;
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xyMi = a.i * a.xy;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double xzMi = a.i * a.xz;
        const double yzMyz = a.yz * a.yz;
        const double yzMi = a.i * a.yz;
        return {
            .wx = 2.0 * (b.xy * (wxMxy + wzMyz - sMwy - xzMi) + b.xz * (wxMxz + xyMi - sMwz - wyMyz) + b.yz * (wxMyz + wyMxz - sMi - wzMxy)),
            .wy = 2.0 * (b.xy * (sMwx + wyMxy - wzMxz - yzMi) + b.xz * (sMi + wxMyz + wyMxz + wzMxy) + b.yz * (wyMyz + xyMi - sMwz - wxMxz)),
            .wz = 2.0 * (b.xy * (wyMxz + wzMxy - sMi - wxMyz) + b.xz * (sMwx + wzMxz - wyMxy - yzMi) + b.yz * (sMwy + wxMxy + wzMyz + xzMi)),
            .xy = (2.0 * (b.xz * (sMyz + xyMxz) + b.yz * (xyMyz - sMxz)) + b.xy * (sMs + xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * (xyMxz - sMyz) + b.yz * (sMxy + xzMyz)) + b.xz * (sMs + xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * (sMxz + xyMyz) + b.xz * (xzMyz - sMxy)) + b.yz * (sMs + yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr Bivector Motor::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const Motor&a, const BivectorWeight& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr BivectorWeight Motor::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const Motor&a, const PseudoScalar& b) noexcept {
        return {
            .i = b.i * (a.s * a.s + a.xy * a.xy + a.xz * a.xz + a.yz * a.yz)
        };
    }
    constexpr PseudoScalar Motor::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Motor&a, const PointCenter& b) noexcept {
        return {
            .x = 2.0 * (-a.i * a.yz - a.s * a.wx - a.wy * a.xy - a.wz * a.xz),
            .y = 2.0 * (a.i * a.xz + a.wx * a.xy - a.s * a.wy - a.wz * a.yz),
            .z = 2.0 * (a.wx * a.xz + a.wy * a.yz - a.i * a.xy - a.s * a.wz),
            .w = (a.s * a.s + a.xy * a.xy + a.xz * a.xz + a.yz * a.yz)
        };
    }
    constexpr ProjectivePoint Motor::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const Plane&a, const Motor& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double xMw = a.w * a.x;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double yMw = a.w * a.y;
        const double zMz = a.z * a.z;
        const double zMw = a.w * a.z;
        return {
            .s = b.s * (xMx + yMy + zMz),
            .wx = (2.0 * (b.xy * yMw + b.xz * zMw - b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (b.yz * zMw - b.wx * xMy - b.wz * yMz - b.xy * xMw) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz - b.xz * xMw - b.yz * yMw) + b.wz * (xMx + yMy - zMz)),
            .xy = (2.0 * (b.yz * xMz - b.xz * yMz) + b.xy * (zMz - xMx - yMy)),
            .xz = (2.0 * (-b.xy * yMz - b.yz * xMy) + b.xz * (yMy - xMx - zMz)),
            .yz = (2.0 * (b.xy * xMz - b.xz * xMy) + b.yz * (xMx - yMy - zMz)),
            .i = b.i * (-xMx - yMy - zMz)
        };
    }
    constexpr Motor Plane::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Plane&a, const Plane& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (b.y * xMy + b.z * xMz) + b.x * (xMx - yMy - zMz)),
            .y = (2.0 * (b.x * xMy + b.z * yMz) + b.y * (yMy - xMx - zMz)),
            .z = (2.0 * (b.x * xMz + b.y * yMz) + b.z * (zMz - xMx - yMy)),
            .w = (b.w * (-xMx - yMy - zMz) + 2.0 * a.w * (a.x * b.x + a.y * b.y + a.z * b.z))
        };
    }
    constexpr Plane Plane::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Plane&a, const Bivector& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double xMw = a.w * a.x;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double yMw = a.w * a.y;
        const double zMz = a.z * a.z;
        const double zMw = a.w * a.z;
        return {
            .wx = (2.0 * (b.xy * yMw + b.xz * zMw - b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (b.yz * zMw - b.wx * xMy - b.wz * yMz - b.xy * xMw) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz - b.xz * xMw - b.yz * yMw) + b.wz * (xMx + yMy - zMz)),
            .xy = (2.0 * (b.yz * xMz - b.xz * yMz) + b.xy * (zMz - xMx - yMy)),
            .xz = (2.0 * (-b.xy * yMz - b.yz * xMy) + b.xz * (yMy - xMx - zMz)),
            .yz = (2.0 * (b.xy * xMz - b.xz * xMy) + b.yz * (xMx - yMy - zMz))
        };
    }
    constexpr Bivector Plane::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Plane&a, const ProjectivePoint& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (-b.y * xMy - b.z * xMz - a.w * a.x * b.w) + b.x * (yMy + zMz - xMx)),
            .y = (2.0 * (-b.x * xMy - b.z * yMz - a.w * a.y * b.w) + b.y * (xMx + zMz - yMy)),
            .z = (2.0 * (-b.x * xMz - b.y * yMz - a.w * a.z * b.w) + b.z * (xMx + yMy - zMz)),
            .w = b.w * (xMx + yMy + zMz)
        };
    }
    constexpr ProjectivePoint Plane::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Plane&a, const Quaternion& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double xMw = a.w * a.x;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double yMw = a.w * a.y;
        const double zMz = a.z * a.z;
        const double zMw = a.w * a.z;
        return {
            .s = b.s * (xMx + yMy + zMz),
            .wx = 2.0 * (b.xy * yMw + b.xz * zMw),
            .wy = 2.0 * (b.yz * zMw - b.xy * xMw),
            .wz = 2.0 * (-b.xz * xMw - b.yz * yMw),
            .xy = (2.0 * (b.yz * xMz - b.xz * yMz) + b.xy * (zMz - xMx - yMy)),
            .xz = (2.0 * (-b.xy * yMz - b.yz * xMy) + b.xz * (yMy - xMx - zMz)),
            .yz = (2.0 * (b.xy * xMz - b.xz * xMy) + b.yz * (xMx - yMy - zMz)),
            .i = 0.0
        };
    }
    constexpr Motor Plane::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const Plane&a, const ProjectiveTranslator& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .s = b.s * (xMx + yMy + zMz),
            .wx = (2.0 * (-b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (-b.wx * xMy - b.wz * yMz) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz) + b.wz * (xMx + yMy - zMz))
        };
    }
    constexpr ProjectiveTranslator Plane::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const Plane&a, const Translator& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .s = (xMx + yMy + zMz),
            .wx = (2.0 * (-b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (-b.wx * xMy - b.wz * yMz) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz) + b.wz * (xMx + yMy - zMz))
        };
    }
    constexpr ProjectiveTranslator Plane::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const Plane&a, const Vector& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (-b.y * xMy - b.z * xMz) + b.x * (yMy + zMz - xMx)),
            .y = (2.0 * (-b.x * xMy - b.z * yMz) + b.y * (xMx + zMz - yMy)),
            .z = (2.0 * (-b.x * xMz - b.y * yMz) + b.z * (xMx + yMy - zMz))
        };
    }
    constexpr Vector Plane::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Plane&a, const Point& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (-a.w * a.x - b.y * xMy - b.z * xMz) + b.x * (yMy + zMz - xMx)),
            .y = (2.0 * (-a.w * a.y - b.x * xMy - b.z * yMz) + b.y * (xMx + zMz - yMy)),
            .z = (2.0 * (-a.w * a.z - b.x * xMz - b.y * yMz) + b.z * (xMx + yMy - zMz)),
            .w = (xMx + yMy + zMz)
        };
    }
    constexpr ProjectivePoint Plane::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Plane&a, const PlaneIdeal& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (b.y * xMy + b.z * xMz) + b.x * (xMx - yMy - zMz)),
            .y = (2.0 * (b.x * xMy + b.z * yMz) + b.y * (yMy - xMx - zMz)),
            .z = (2.0 * (b.x * xMz + b.y * yMz) + b.z * (zMz - xMx - yMy)),
            .w = 2.0 * a.w * (a.x * b.x + a.y * b.y + a.z * b.z)
        };
    }
    constexpr Plane Plane::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Plane&a, const BivectorBulk& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double xMw = a.w * a.x;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double yMw = a.w * a.y;
        const double zMz = a.z * a.z;
        const double zMw = a.w * a.z;
        return {
            .wx = 2.0 * (b.xy * yMw + b.xz * zMw),
            .wy = 2.0 * (b.yz * zMw - b.xy * xMw),
            .wz = 2.0 * (-b.xz * xMw - b.yz * yMw),
            .xy = (2.0 * (b.yz * xMz - b.xz * yMz) + b.xy * (zMz - xMx - yMy)),
            .xz = (2.0 * (-b.xy * yMz - b.yz * xMy) + b.xz * (yMy - xMx - zMz)),
            .yz = (2.0 * (b.xy * xMz - b.xz * xMy) + b.yz * (xMx - yMy - zMz))
        };
    }
    constexpr Bivector Plane::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const Plane&a, const BivectorWeight& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .wx = (2.0 * (-b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (-b.wx * xMy - b.wz * yMz) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz) + b.wz * (xMx + yMy - zMz))
        };
    }
    constexpr BivectorWeight Plane::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const Plane&a, const PseudoScalar& b) noexcept {
        return {
            .i = b.i * (-a.x * a.x - a.y * a.y - a.z * a.z)
        };
    }
    constexpr PseudoScalar Plane::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Plane&a, const PointCenter& b) noexcept {
        return {
            .x = -2.0 * a.w * a.x,
            .y = -2.0 * a.w * a.y,
            .z = -2.0 * a.w * a.z,
            .w = (a.x * a.x + a.y * a.y + a.z * a.z)
        };
    }
    constexpr ProjectivePoint Plane::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const Bivector&a, const Motor& b) noexcept {
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wz * xyMyz + b.xy * (wxMxy + wzMyz) + b.xz * (wxMxz - wyMyz) + b.yz * (wxMyz + wyMxz - wzMxy) - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.xy * (wyMxy - wzMxz) + b.xz * (wxMyz + wyMxz + wzMxy) + b.yz * (wyMyz - wxMxz) - b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz + b.xy * (wyMxz + wzMxy - wxMyz) + b.xz * (wzMxz - wyMxy) + b.yz * (wxMxy + wzMyz) - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz)),
            .xy = (2.0 * (b.xz * xyMxz + b.yz * xyMyz) + b.xy * (xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * xyMxz + b.yz * xzMyz) + b.xz * (xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * xyMyz + b.xz * xzMyz) + b.yz * (yzMyz - xyMxy - xzMxz)),
            .i = (b.i * (xyMxy + xzMxz + yzMyz) + 2.0 * b.s * (wyMxz - wxMyz - wzMxy))
        };
    }
    constexpr Motor Bivector::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Bivector&a, const Plane& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (-b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz)),
            .w = (2.0 * (a.wx * (a.xy * b.y + a.xz * b.z) + a.wy * (a.yz * b.z - a.xy * b.x) + a.wz * (-a.xz * b.x - a.yz * b.y)) + b.w * (xyMxy + xzMxz + yzMyz))
        };
    }
    constexpr Plane Bivector::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Bivector&a, const Bivector& b) noexcept {
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .wx = (2.0 * (b.wz * xyMyz + b.xy * (wxMxy + wzMyz) + b.xz * (wxMxz - wyMyz) + b.yz * (wxMyz + wyMxz - wzMxy) - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.xy * (wyMxy - wzMxz) + b.xz * (wxMyz + wyMxz + wzMxy) + b.yz * (wyMyz - wxMxz) - b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz + b.xy * (wyMxz + wzMxy - wxMyz) + b.xz * (wzMxz - wyMxy) + b.yz * (wxMxy + wzMyz) - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz)),
            .xy = (2.0 * (b.xz * xyMxz + b.yz * xyMyz) + b.xy * (xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * xyMxz + b.yz * xzMyz) + b.xz * (xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * xyMyz + b.xz * xzMyz) + b.yz * (yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr Bivector Bivector::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Bivector&a, const ProjectivePoint& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.w * (-a.wy * a.xy - a.wz * a.xz) + b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.w * (a.wx * a.xy - a.wz * a.yz) - b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.w * (a.wx * a.xz + a.wy * a.yz) + b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz)),
            .w = b.w * (xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr ProjectivePoint Bivector::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Bivector&a, const Quaternion& b) noexcept {
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (xyMxy + xzMxz + yzMyz),
            .wx = 2.0 * (b.xy * (wxMxy + wzMyz) + b.xz * (wxMxz - wyMyz) + b.yz * (wxMyz + wyMxz - wzMxy)),
            .wy = 2.0 * (b.xy * (wyMxy - wzMxz) + b.xz * (wxMyz + wyMxz + wzMxy) + b.yz * (wyMyz - wxMxz)),
            .wz = 2.0 * (b.xy * (wyMxz + wzMxy - wxMyz) + b.xz * (wzMxz - wyMxy) + b.yz * (wxMxy + wzMyz)),
            .xy = (2.0 * (b.xz * xyMxz + b.yz * xyMyz) + b.xy * (xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * xyMxz + b.yz * xzMyz) + b.xz * (xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * xyMyz + b.xz * xzMyz) + b.yz * (yzMyz - xyMxy - xzMxz)),
            .i = 2.0 * b.s * (wyMxz - wxMyz - wzMxy)
        };
    }
    constexpr Motor Bivector::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Bivector&a, const ProjectiveTranslator& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wz * xyMyz - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (-b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz)),
            .xy = 0.0,
            .xz = 0.0,
            .yz = 0.0,
            .i = 2.0 * b.s * (a.wy * a.xz - a.wx * a.yz - a.wz * a.xy)
        };
    }
    constexpr Motor Bivector::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Bivector&a, const Translator& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = (xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wz * xyMyz - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (-b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz)),
            .xy = 0.0,
            .xz = 0.0,
            .yz = 0.0,
            .i = 2.0 * (a.wy * a.xz - a.wx * a.yz - a.wz * a.xy)
        };
    }
    constexpr Motor Bivector::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const Bivector&a, const Vector& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (-b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr Vector Bivector::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Bivector&a, const Point& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - a.wy * a.xy - a.wz * a.xz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (a.wx * a.xy - a.wz * a.yz - b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (a.wx * a.xz + a.wy * a.yz + b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz)),
            .w = (xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr ProjectivePoint Bivector::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Bivector&a, const PlaneIdeal& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (-b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz)),
            .w = 2.0 * (a.wx * (a.xy * b.y + a.xz * b.z) + a.wy * (a.yz * b.z - a.xy * b.x) + a.wz * (-a.xz * b.x - a.yz * b.y))
        };
    }
    constexpr Plane Bivector::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Bivector&a, const BivectorBulk& b) noexcept {
        const double wxMxy = a.wx * a.xy;
        const double wxMxz = a.wx * a.xz;
        const double wxMyz = a.wx * a.yz;
        const double wyMxy = a.wy * a.xy;
        const double wyMxz = a.wy * a.xz;
        const double wyMyz = a.wy * a.yz;
        const double wzMxy = a.wz * a.xy;
        const double wzMxz = a.wz * a.xz;
        const double wzMyz = a.wz * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .wx = 2.0 * (b.xy * (wxMxy + wzMyz) + b.xz * (wxMxz - wyMyz) + b.yz * (wxMyz + wyMxz - wzMxy)),
            .wy = 2.0 * (b.xy * (wyMxy - wzMxz) + b.xz * (wxMyz + wyMxz + wzMxy) + b.yz * (wyMyz - wxMxz)),
            .wz = 2.0 * (b.xy * (wyMxz + wzMxy - wxMyz) + b.xz * (wzMxz - wyMxy) + b.yz * (wxMxy + wzMyz)),
            .xy = (2.0 * (b.xz * xyMxz + b.yz * xyMyz) + b.xy * (xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * xyMxz + b.yz * xzMyz) + b.xz * (xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * xyMyz + b.xz * xzMyz) + b.yz * (yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr Bivector Bivector::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const Bivector&a, const BivectorWeight& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .wx = (2.0 * (b.wz * xyMyz - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (-b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr BivectorWeight Bivector::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const Bivector&a, const PseudoScalar& b) noexcept {
        return {
            .i = b.i * (a.xy * a.xy + a.xz * a.xz + a.yz * a.yz)
        };
    }
    constexpr PseudoScalar Bivector::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Bivector&a, const PointCenter& b) noexcept {
        return {
            .x = 2.0 * (-a.wy * a.xy - a.wz * a.xz),
            .y = 2.0 * (a.wx * a.xy - a.wz * a.yz),
            .z = 2.0 * (a.wx * a.xz + a.wy * a.yz),
            .w = (a.xy * a.xy + a.xz * a.xz + a.yz * a.yz)
        };
    }
    constexpr ProjectivePoint Bivector::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const ProjectivePoint&a, const Motor& b) noexcept {
        const double xMw = a.w * a.x;
        const double yMw = a.w * a.y;
        const double zMw = a.w * a.z;
        const double wMw = a.w * a.w;
        return {
            .s = b.s * wMw,
            .wx = (2.0 * (b.xy * yMw + b.xz * zMw) - b.wx * wMw),
            .wy = (2.0 * (b.yz * zMw - b.xy * xMw) - b.wy * wMw),
            .wz = (2.0 * (-b.xz * xMw - b.yz * yMw) - b.wz * wMw),
            .xy = b.xy * wMw,
            .xz = b.xz * wMw,
            .yz = b.yz * wMw,
            .i = -b.i * wMw
        };
    }
    constexpr Motor ProjectivePoint::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const ProjectivePoint&a, const Plane& b) noexcept {
        const double wMw = a.w * a.w;
        return {
            .x = b.x * wMw,
            .y = b.y * wMw,
            .z = b.z * wMw,
            .w = (-b.w * wMw + 2.0 * a.w * (-a.x * b.x - a.y * b.y - a.z * b.z))
        };
    }
    constexpr Plane ProjectivePoint::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const ProjectivePoint&a, const Bivector& b) noexcept {
        const double xMw = a.w * a.x;
        const double yMw = a.w * a.y;
        const double zMw = a.w * a.z;
        const double wMw = a.w * a.w;
        return {
            .wx = (2.0 * (b.xy * yMw + b.xz * zMw) - b.wx * wMw),
            .wy = (2.0 * (b.yz * zMw - b.xy * xMw) - b.wy * wMw),
            .wz = (2.0 * (-b.xz * xMw - b.yz * yMw) - b.wz * wMw),
            .xy = b.xy * wMw,
            .xz = b.xz * wMw,
            .yz = b.yz * wMw
        };
    }
    constexpr Bivector ProjectivePoint::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const ProjectivePoint&a, const ProjectivePoint& b) noexcept {
        const double wMw = a.w * a.w;
        return {
            .x = (-b.x * wMw + 2.0 * a.w * a.x * b.w),
            .y = (-b.y * wMw + 2.0 * a.w * a.y * b.w),
            .z = (-b.z * wMw + 2.0 * a.w * a.z * b.w),
            .w = b.w * wMw
        };
    }
    constexpr ProjectivePoint ProjectivePoint::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const ProjectivePoint&a, const Quaternion& b) noexcept {
        const double xMw = a.w * a.x;
        const double yMw = a.w * a.y;
        const double zMw = a.w * a.z;
        const double wMw = a.w * a.w;
        return {
            .s = b.s * wMw,
            .wx = 2.0 * (b.xy * yMw + b.xz * zMw),
            .wy = 2.0 * (b.yz * zMw - b.xy * xMw),
            .wz = 2.0 * (-b.xz * xMw - b.yz * yMw),
            .xy = b.xy * wMw,
            .xz = b.xz * wMw,
            .yz = b.yz * wMw,
            .i = 0.0
        };
    }
    constexpr Motor ProjectivePoint::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const ProjectivePoint&a, const ProjectiveTranslator& b) noexcept {
        const double wMw = a.w * a.w;
        return {
            .s = b.s * wMw,
            .wx = -b.wx * wMw,
            .wy = -b.wy * wMw,
            .wz = -b.wz * wMw
        };
    }
    constexpr ProjectiveTranslator ProjectivePoint::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const ProjectivePoint&a, const Translator& b) noexcept {
        const double wMw = a.w * a.w;
        return {
            .s = wMw,
            .wx = -b.wx * wMw,
            .wy = -b.wy * wMw,
            .wz = -b.wz * wMw
        };
    }
    constexpr ProjectiveTranslator ProjectivePoint::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const ProjectivePoint&a, const Vector& b) noexcept {
        const double wMw = a.w * a.w;
        return {
            .x = -b.x * wMw,
            .y = -b.y * wMw,
            .z = -b.z * wMw
        };
    }
    constexpr Vector ProjectivePoint::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const ProjectivePoint&a, const Point& b) noexcept {
        const double wMw = a.w * a.w;
        return {
            .x = (-b.x * wMw + 2.0 * a.w * a.x),
            .y = (-b.y * wMw + 2.0 * a.w * a.y),
            .z = (-b.z * wMw + 2.0 * a.w * a.z),
            .w = wMw
        };
    }
    constexpr ProjectivePoint ProjectivePoint::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const ProjectivePoint&a, const PlaneIdeal& b) noexcept {
        const double wMw = a.w * a.w;
        return {
            .x = b.x * wMw,
            .y = b.y * wMw,
            .z = b.z * wMw,
            .w = 2.0 * a.w * (-a.x * b.x - a.y * b.y - a.z * b.z)
        };
    }
    constexpr Plane ProjectivePoint::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const ProjectivePoint&a, const BivectorBulk& b) noexcept {
        const double xMw = a.w * a.x;
        const double yMw = a.w * a.y;
        const double zMw = a.w * a.z;
        const double wMw = a.w * a.w;
        return {
            .wx = 2.0 * (b.xy * yMw + b.xz * zMw),
            .wy = 2.0 * (b.yz * zMw - b.xy * xMw),
            .wz = 2.0 * (-b.xz * xMw - b.yz * yMw),
            .xy = b.xy * wMw,
            .xz = b.xz * wMw,
            .yz = b.yz * wMw
        };
    }
    constexpr Bivector ProjectivePoint::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const ProjectivePoint&a, const BivectorWeight& b) noexcept {
        const double wMw = a.w * a.w;
        return {
            .wx = -b.wx * wMw,
            .wy = -b.wy * wMw,
            .wz = -b.wz * wMw
        };
    }
    constexpr BivectorWeight ProjectivePoint::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const ProjectivePoint&a, const PseudoScalar& b) noexcept {
        return {
            .i = -a.w * a.w * b.i
        };
    }
    constexpr PseudoScalar ProjectivePoint::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const ProjectivePoint&a, const PointCenter& b) noexcept {
        return {
            .x = 2.0 * a.w * a.x,
            .y = 2.0 * a.w * a.y,
            .z = 2.0 * a.w * a.z,
            .w = a.w * a.w
        };
    }
    constexpr ProjectivePoint ProjectivePoint::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const Quaternion&a, const Motor& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (sMs + xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz)),
            .xy = (2.0 * (b.xz * (sMyz + xyMxz) + b.yz * (xyMyz - sMxz)) + b.xy * (sMs + xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * (xyMxz - sMyz) + b.yz * (sMxy + xzMyz)) + b.xz * (sMs + xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * (sMxz + xyMyz) + b.xz * (xzMyz - sMxy)) + b.yz * (sMs + yzMyz - xyMxy - xzMxz)),
            .i = b.i * (sMs + xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr Motor Quaternion::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Quaternion&a, const Plane& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz)),
            .w = b.w * (sMs + xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr Plane Quaternion::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Quaternion&a, const Bivector& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz)),
            .xy = (2.0 * (b.xz * (sMyz + xyMxz) + b.yz * (xyMyz - sMxz)) + b.xy * (sMs + xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * (xyMxz - sMyz) + b.yz * (sMxy + xzMyz)) + b.xz * (sMs + xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * (sMxz + xyMyz) + b.xz * (xzMyz - sMxy)) + b.yz * (sMs + yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr Bivector Quaternion::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Quaternion&a, const ProjectivePoint& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz)),
            .w = b.w * (sMs + xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr ProjectivePoint Quaternion::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Quaternion sandwich(const Quaternion&a, const Quaternion& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (sMs + xyMxy + xzMxz + yzMyz),
            .xy = (2.0 * (b.xz * (sMyz + xyMxz) + b.yz * (xyMyz - sMxz)) + b.xy * (sMs + xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * (xyMxz - sMyz) + b.yz * (sMxy + xzMyz)) + b.xz * (sMs + xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * (sMxz + xyMyz) + b.xz * (xzMyz - sMxy)) + b.yz * (sMs + yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr Quaternion Quaternion::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const Quaternion&a, const ProjectiveTranslator& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (sMs + xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr ProjectiveTranslator Quaternion::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const Quaternion&a, const Translator& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = (sMs + xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr ProjectiveTranslator Quaternion::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const Quaternion&a, const Vector& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr Vector Quaternion::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Quaternion&a, const Point& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz)),
            .w = (sMs + xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr ProjectivePoint Quaternion::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PlaneIdeal sandwich(const Quaternion&a, const PlaneIdeal& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.y * (sMxy - xzMyz) + b.z * (sMxz + xyMyz)) + b.x * (sMs + yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (b.x * (-sMxy - xzMyz) + b.z * (sMyz - xyMxz)) + b.y * (sMs + xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * (xyMyz - sMxz) + b.y * (-sMyz - xyMxz)) + b.z * (sMs + xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr PlaneIdeal Quaternion::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorBulk sandwich(const Quaternion&a, const BivectorBulk& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .xy = (2.0 * (b.xz * (sMyz + xyMxz) + b.yz * (xyMyz - sMxz)) + b.xy * (sMs + xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * (xyMxz - sMyz) + b.yz * (sMxy + xzMyz)) + b.xz * (sMs + xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * (sMxz + xyMyz) + b.xz * (xzMyz - sMxy)) + b.yz * (sMs + yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr BivectorBulk Quaternion::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const Quaternion&a, const BivectorWeight& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMxy = a.s * a.xy;
        const double sMxz = a.s * a.xz;
        const double sMyz = a.s * a.yz;
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .wx = (2.0 * (b.wy * (sMxy - xzMyz) + b.wz * (sMxz + xyMyz)) + b.wx * (sMs + yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (b.wx * (-sMxy - xzMyz) + b.wz * (sMyz - xyMxz)) + b.wy * (sMs + xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * (xyMyz - sMxz) + b.wy * (-sMyz - xyMxz)) + b.wz * (sMs + xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr BivectorWeight Quaternion::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const Quaternion&a, const PseudoScalar& b) noexcept {
        return {
            .i = b.i * (a.s * a.s + a.xy * a.xy + a.xz * a.xz + a.yz * a.yz)
        };
    }
    constexpr PseudoScalar Quaternion::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Quaternion&a, const PointCenter& b) noexcept {
        return {
            .x = 0.0,
            .y = 0.0,
            .z = 0.0,
            .w = (a.s * a.s + a.xy * a.xy + a.xz * a.xz + a.yz * a.yz)
        };
    }
    constexpr ProjectivePoint Quaternion::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const ProjectiveTranslator&a, const Motor& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        return {
            .s = b.s * sMs,
            .wx = (2.0 * (-b.xy * sMwy - b.xz * sMwz) + b.wx * sMs),
            .wy = (2.0 * (b.xy * sMwx - b.yz * sMwz) + b.wy * sMs),
            .wz = (2.0 * (b.xz * sMwx + b.yz * sMwy) + b.wz * sMs),
            .xy = b.xy * sMs,
            .xz = b.xz * sMs,
            .yz = b.yz * sMs,
            .i = b.i * sMs
        };
    }
    constexpr Motor ProjectiveTranslator::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const ProjectiveTranslator&a, const Plane& b) noexcept {
        const double sMs = a.s * a.s;
        return {
            .x = b.x * sMs,
            .y = b.y * sMs,
            .z = b.z * sMs,
            .w = (b.w * sMs + 2.0 * a.s * (a.wx * b.x + a.wy * b.y + a.wz * b.z))
        };
    }
    constexpr Plane ProjectiveTranslator::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const ProjectiveTranslator&a, const Bivector& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        return {
            .wx = (2.0 * (-b.xy * sMwy - b.xz * sMwz) + b.wx * sMs),
            .wy = (2.0 * (b.xy * sMwx - b.yz * sMwz) + b.wy * sMs),
            .wz = (2.0 * (b.xz * sMwx + b.yz * sMwy) + b.wz * sMs),
            .xy = b.xy * sMs,
            .xz = b.xz * sMs,
            .yz = b.yz * sMs
        };
    }
    constexpr Bivector ProjectiveTranslator::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const ProjectiveTranslator&a, const ProjectivePoint& b) noexcept {
        const double sMs = a.s * a.s;
        return {
            .x = (b.x * sMs - 2.0 * a.s * a.wx * b.w),
            .y = (b.y * sMs - 2.0 * a.s * a.wy * b.w),
            .z = (b.z * sMs - 2.0 * a.s * a.wz * b.w),
            .w = b.w * sMs
        };
    }
    constexpr ProjectivePoint ProjectiveTranslator::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const ProjectiveTranslator&a, const Quaternion& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        return {
            .s = b.s * sMs,
            .wx = 2.0 * (-b.xy * sMwy - b.xz * sMwz),
            .wy = 2.0 * (b.xy * sMwx - b.yz * sMwz),
            .wz = 2.0 * (b.xz * sMwx + b.yz * sMwy),
            .xy = b.xy * sMs,
            .xz = b.xz * sMs,
            .yz = b.yz * sMs,
            .i = 0.0
        };
    }
    constexpr Motor ProjectiveTranslator::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const ProjectiveTranslator&a, const ProjectiveTranslator& b) noexcept {
        const double sMs = a.s * a.s;
        return {
            .s = b.s * sMs,
            .wx = b.wx * sMs,
            .wy = b.wy * sMs,
            .wz = b.wz * sMs
        };
    }
    constexpr ProjectiveTranslator ProjectiveTranslator::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const ProjectiveTranslator&a, const Translator& b) noexcept {
        const double sMs = a.s * a.s;
        return {
            .s = sMs,
            .wx = b.wx * sMs,
            .wy = b.wy * sMs,
            .wz = b.wz * sMs
        };
    }
    constexpr ProjectiveTranslator ProjectiveTranslator::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const ProjectiveTranslator&a, const Vector& b) noexcept {
        const double sMs = a.s * a.s;
        return {
            .x = b.x * sMs,
            .y = b.y * sMs,
            .z = b.z * sMs
        };
    }
    constexpr Vector ProjectiveTranslator::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const ProjectiveTranslator&a, const Point& b) noexcept {
        const double sMs = a.s * a.s;
        return {
            .x = (b.x * sMs - 2.0 * a.s * a.wx),
            .y = (b.y * sMs - 2.0 * a.s * a.wy),
            .z = (b.z * sMs - 2.0 * a.s * a.wz),
            .w = sMs
        };
    }
    constexpr ProjectivePoint ProjectiveTranslator::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const ProjectiveTranslator&a, const PlaneIdeal& b) noexcept {
        const double sMs = a.s * a.s;
        return {
            .x = b.x * sMs,
            .y = b.y * sMs,
            .z = b.z * sMs,
            .w = 2.0 * a.s * (a.wx * b.x + a.wy * b.y + a.wz * b.z)
        };
    }
    constexpr Plane ProjectiveTranslator::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const ProjectiveTranslator&a, const BivectorBulk& b) noexcept {
        const double sMs = a.s * a.s;
        const double sMwx = a.s * a.wx;
        const double sMwy = a.s * a.wy;
        const double sMwz = a.s * a.wz;
        return {
            .wx = 2.0 * (-b.xy * sMwy - b.xz * sMwz),
            .wy = 2.0 * (b.xy * sMwx - b.yz * sMwz),
            .wz = 2.0 * (b.xz * sMwx + b.yz * sMwy),
            .xy = b.xy * sMs,
            .xz = b.xz * sMs,
            .yz = b.yz * sMs
        };
    }
    constexpr Bivector ProjectiveTranslator::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const ProjectiveTranslator&a, const BivectorWeight& b) noexcept {
        const double sMs = a.s * a.s;
        return {
            .wx = b.wx * sMs,
            .wy = b.wy * sMs,
            .wz = b.wz * sMs
        };
    }
    constexpr BivectorWeight ProjectiveTranslator::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const ProjectiveTranslator&a, const PseudoScalar& b) noexcept {
        return {
            .i = a.s * a.s * b.i
        };
    }
    constexpr PseudoScalar ProjectiveTranslator::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const ProjectiveTranslator&a, const PointCenter& b) noexcept {
        return {
            .x = -2.0 * a.s * a.wx,
            .y = -2.0 * a.s * a.wy,
            .z = -2.0 * a.s * a.wz,
            .w = a.s * a.s
        };
    }
    constexpr ProjectivePoint ProjectiveTranslator::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const Translator&a, const Motor& b) noexcept {
        return {
            .s = b.s,
            .wx = (b.wx - 2.0 * a.wy * b.xy - 2.0 * a.wz * b.xz),
            .wy = (b.wy - 2.0 * a.wz * b.yz + 2.0 * a.wx * b.xy),
            .wz = (b.wz + 2.0 * a.wx * b.xz + 2.0 * a.wy * b.yz),
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz,
            .i = b.i
        };
    }
    constexpr Motor Translator::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Translator&a, const Plane& b) noexcept {
        return {
            .x = b.x,
            .y = b.y,
            .z = b.z,
            .w = (b.w + 2.0 * a.wx * b.x + 2.0 * a.wy * b.y + 2.0 * a.wz * b.z)
        };
    }
    constexpr Plane Translator::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Translator&a, const Bivector& b) noexcept {
        return {
            .wx = (b.wx - 2.0 * a.wy * b.xy - 2.0 * a.wz * b.xz),
            .wy = (b.wy - 2.0 * a.wz * b.yz + 2.0 * a.wx * b.xy),
            .wz = (b.wz + 2.0 * a.wx * b.xz + 2.0 * a.wy * b.yz),
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz
        };
    }
    constexpr Bivector Translator::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Translator&a, const ProjectivePoint& b) noexcept {
        return {
            .x = (b.x - 2.0 * a.wx * b.w),
            .y = (b.y - 2.0 * a.wy * b.w),
            .z = (b.z - 2.0 * a.wz * b.w),
            .w = b.w
        };
    }
    constexpr ProjectivePoint Translator::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Translator&a, const Quaternion& b) noexcept {
        return {
            .s = b.s,
            .wx = 2.0 * (-a.wy * b.xy - a.wz * b.xz),
            .wy = 2.0 * (a.wx * b.xy - a.wz * b.yz),
            .wz = 2.0 * (a.wx * b.xz + a.wy * b.yz),
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz,
            .i = 0.0
        };
    }
    constexpr Motor Translator::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const Translator&a, const ProjectiveTranslator& b) noexcept {
        return {
            .s = b.s,
            .wx = b.wx,
            .wy = b.wy,
            .wz = b.wz
        };
    }
    constexpr ProjectiveTranslator Translator::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Translator sandwich(const Translator&a, const Translator& b) noexcept {
        return {
            .wx = b.wx,
            .wy = b.wy,
            .wz = b.wz
        };
    }
    constexpr Translator Translator::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const Translator&a, const Vector& b) noexcept {
        return {
            .x = b.x,
            .y = b.y,
            .z = b.z
        };
    }
    constexpr Vector Translator::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Point sandwich(const Translator&a, const Point& b) noexcept {
        return {
            .x = (b.x - 2.0 * a.wx),
            .y = (b.y - 2.0 * a.wy),
            .z = (b.z - 2.0 * a.wz)
        };
    }
    constexpr Point Translator::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Translator&a, const PlaneIdeal& b) noexcept {
        return {
            .x = b.x,
            .y = b.y,
            .z = b.z,
            .w = 2.0 * (a.wx * b.x + a.wy * b.y + a.wz * b.z)
        };
    }
    constexpr Plane Translator::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Translator&a, const BivectorBulk& b) noexcept {
        return {
            .wx = 2.0 * (-a.wy * b.xy - a.wz * b.xz),
            .wy = 2.0 * (a.wx * b.xy - a.wz * b.yz),
            .wz = 2.0 * (a.wx * b.xz + a.wy * b.yz),
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz
        };
    }
    constexpr Bivector Translator::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const Translator&a, const BivectorWeight& b) noexcept {
        return {
            .wx = b.wx,
            .wy = b.wy,
            .wz = b.wz
        };
    }
    constexpr BivectorWeight Translator::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const Translator&a, const PseudoScalar& b) noexcept {
        return {
            .i = b.i
        };
    }
    constexpr PseudoScalar Translator::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Point sandwich(const Translator&a, const PointCenter& b) noexcept {
        return {
            .x = -2.0 * a.wx,
            .y = -2.0 * a.wy,
            .z = -2.0 * a.wz
        };
    }
    constexpr Point Translator::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }



    [[nodiscard]] constexpr Motor sandwich(const Point&a, const Motor& b) noexcept {
        return {
            .s = b.s,
            .wx = (-b.wx + 2.0 * (a.y * b.xy + a.z * b.xz)),
            .wy = (-b.wy + 2.0 * (a.z * b.yz - a.x * b.xy)),
            .wz = (-b.wz + 2.0 * (-a.x * b.xz - a.y * b.yz)),
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz,
            .i = -b.i
        };
    }
    constexpr Motor Point::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Point&a, const Plane& b) noexcept {
        return {
            .x = b.x,
            .y = b.y,
            .z = b.z,
            .w = (-b.w + 2.0 * (-a.x * b.x - a.y * b.y - a.z * b.z))
        };
    }
    constexpr Plane Point::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Point&a, const Bivector& b) noexcept {
        return {
            .wx = (-b.wx + 2.0 * (a.y * b.xy + a.z * b.xz)),
            .wy = (-b.wy + 2.0 * (a.z * b.yz - a.x * b.xy)),
            .wz = (-b.wz + 2.0 * (-a.x * b.xz - a.y * b.yz)),
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz
        };
    }
    constexpr Bivector Point::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const Point&a, const ProjectivePoint& b) noexcept {
        return {
            .x = (-b.x + 2.0 * a.x * b.w),
            .y = (-b.y + 2.0 * a.y * b.w),
            .z = (-b.z + 2.0 * a.z * b.w),
            .w = b.w
        };
    }
    constexpr ProjectivePoint Point::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Motor sandwich(const Point&a, const Quaternion& b) noexcept {
        return {
            .s = b.s,
            .wx = 2.0 * (a.y * b.xy + a.z * b.xz),
            .wy = 2.0 * (a.z * b.yz - a.x * b.xy),
            .wz = 2.0 * (-a.x * b.xz - a.y * b.yz),
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz,
            .i = 0.0
        };
    }
    constexpr Motor Point::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const Point&a, const ProjectiveTranslator& b) noexcept {
        return {
            .s = b.s,
            .wx = -b.wx,
            .wy = -b.wy,
            .wz = -b.wz
        };
    }
    constexpr ProjectiveTranslator Point::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Translator sandwich(const Point&a, const Translator& b) noexcept {
        return {
            .wx = -b.wx,
            .wy = -b.wy,
            .wz = -b.wz
        };
    }
    constexpr Translator Point::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const Point&a, const Vector& b) noexcept {
        return {
            .x = -b.x,
            .y = -b.y,
            .z = -b.z
        };
    }
    constexpr Vector Point::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Point sandwich(const Point&a, const Point& b) noexcept {
        return {
            .x = (-b.x + 2.0 * a.x),
            .y = (-b.y + 2.0 * a.y),
            .z = (-b.z + 2.0 * a.z)
        };
    }
    constexpr Point Point::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const Point&a, const PlaneIdeal& b) noexcept {
        return {
            .x = b.x,
            .y = b.y,
            .z = b.z,
            .w = 2.0 * (-a.x * b.x - a.y * b.y - a.z * b.z)
        };
    }
    constexpr Plane Point::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const Point&a, const BivectorBulk& b) noexcept {
        return {
            .wx = 2.0 * (a.y * b.xy + a.z * b.xz),
            .wy = 2.0 * (a.z * b.yz - a.x * b.xy),
            .wz = 2.0 * (-a.x * b.xz - a.y * b.yz),
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz
        };
    }
    constexpr Bivector Point::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const Point&a, const BivectorWeight& b) noexcept {
        return {
            .wx = -b.wx,
            .wy = -b.wy,
            .wz = -b.wz
        };
    }
    constexpr BivectorWeight Point::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const Point&a, const PseudoScalar& b) noexcept {
        return {
            .i = -b.i
        };
    }
    constexpr PseudoScalar Point::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Point sandwich(const Point&a, const PointCenter& b) noexcept {
        return {
            .x = 2.0 * a.x,
            .y = 2.0 * a.y,
            .z = 2.0 * a.z
        };
    }
    constexpr Point Point::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const PlaneIdeal&a, const Motor& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .s = b.s * (xMx + yMy + zMz),
            .wx = (2.0 * (-b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (-b.wx * xMy - b.wz * yMz) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz) + b.wz * (xMx + yMy - zMz)),
            .xy = (2.0 * (b.yz * xMz - b.xz * yMz) + b.xy * (zMz - xMx - yMy)),
            .xz = (2.0 * (-b.xy * yMz - b.yz * xMy) + b.xz * (yMy - xMx - zMz)),
            .yz = (2.0 * (b.xy * xMz - b.xz * xMy) + b.yz * (xMx - yMy - zMz)),
            .i = b.i * (-xMx - yMy - zMz)
        };
    }
    constexpr Motor PlaneIdeal::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const PlaneIdeal&a, const Plane& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (b.y * xMy + b.z * xMz) + b.x * (xMx - yMy - zMz)),
            .y = (2.0 * (b.x * xMy + b.z * yMz) + b.y * (yMy - xMx - zMz)),
            .z = (2.0 * (b.x * xMz + b.y * yMz) + b.z * (zMz - xMx - yMy)),
            .w = b.w * (-xMx - yMy - zMz)
        };
    }
    constexpr Plane PlaneIdeal::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const PlaneIdeal&a, const Bivector& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .wx = (2.0 * (-b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (-b.wx * xMy - b.wz * yMz) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz) + b.wz * (xMx + yMy - zMz)),
            .xy = (2.0 * (b.yz * xMz - b.xz * yMz) + b.xy * (zMz - xMx - yMy)),
            .xz = (2.0 * (-b.xy * yMz - b.yz * xMy) + b.xz * (yMy - xMx - zMz)),
            .yz = (2.0 * (b.xy * xMz - b.xz * xMy) + b.yz * (xMx - yMy - zMz))
        };
    }
    constexpr Bivector PlaneIdeal::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const PlaneIdeal&a, const ProjectivePoint& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (-b.y * xMy - b.z * xMz) + b.x * (yMy + zMz - xMx)),
            .y = (2.0 * (-b.x * xMy - b.z * yMz) + b.y * (xMx + zMz - yMy)),
            .z = (2.0 * (-b.x * xMz - b.y * yMz) + b.z * (xMx + yMy - zMz)),
            .w = b.w * (xMx + yMy + zMz)
        };
    }
    constexpr ProjectivePoint PlaneIdeal::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Quaternion sandwich(const PlaneIdeal&a, const Quaternion& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .s = b.s * (xMx + yMy + zMz),
            .xy = (2.0 * (b.yz * xMz - b.xz * yMz) + b.xy * (zMz - xMx - yMy)),
            .xz = (2.0 * (-b.xy * yMz - b.yz * xMy) + b.xz * (yMy - xMx - zMz)),
            .yz = (2.0 * (b.xy * xMz - b.xz * xMy) + b.yz * (xMx - yMy - zMz))
        };
    }
    constexpr Quaternion PlaneIdeal::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const PlaneIdeal&a, const ProjectiveTranslator& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .s = b.s * (xMx + yMy + zMz),
            .wx = (2.0 * (-b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (-b.wx * xMy - b.wz * yMz) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz) + b.wz * (xMx + yMy - zMz))
        };
    }
    constexpr ProjectiveTranslator PlaneIdeal::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const PlaneIdeal&a, const Translator& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .s = (xMx + yMy + zMz),
            .wx = (2.0 * (-b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (-b.wx * xMy - b.wz * yMz) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz) + b.wz * (xMx + yMy - zMz))
        };
    }
    constexpr ProjectiveTranslator PlaneIdeal::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const PlaneIdeal&a, const Vector& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (-b.y * xMy - b.z * xMz) + b.x * (yMy + zMz - xMx)),
            .y = (2.0 * (-b.x * xMy - b.z * yMz) + b.y * (xMx + zMz - yMy)),
            .z = (2.0 * (-b.x * xMz - b.y * yMz) + b.z * (xMx + yMy - zMz))
        };
    }
    constexpr Vector PlaneIdeal::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const PlaneIdeal&a, const Point& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (-b.y * xMy - b.z * xMz) + b.x * (yMy + zMz - xMx)),
            .y = (2.0 * (-b.x * xMy - b.z * yMz) + b.y * (xMx + zMz - yMy)),
            .z = (2.0 * (-b.x * xMz - b.y * yMz) + b.z * (xMx + yMy - zMz)),
            .w = (xMx + yMy + zMz)
        };
    }
    constexpr ProjectivePoint PlaneIdeal::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PlaneIdeal sandwich(const PlaneIdeal&a, const PlaneIdeal& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .x = (2.0 * (b.y * xMy + b.z * xMz) + b.x * (xMx - yMy - zMz)),
            .y = (2.0 * (b.x * xMy + b.z * yMz) + b.y * (yMy - xMx - zMz)),
            .z = (2.0 * (b.x * xMz + b.y * yMz) + b.z * (zMz - xMx - yMy))
        };
    }
    constexpr PlaneIdeal PlaneIdeal::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorBulk sandwich(const PlaneIdeal&a, const BivectorBulk& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .xy = (2.0 * (b.yz * xMz - b.xz * yMz) + b.xy * (zMz - xMx - yMy)),
            .xz = (2.0 * (-b.xy * yMz - b.yz * xMy) + b.xz * (yMy - xMx - zMz)),
            .yz = (2.0 * (b.xy * xMz - b.xz * xMy) + b.yz * (xMx - yMy - zMz))
        };
    }
    constexpr BivectorBulk PlaneIdeal::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const PlaneIdeal&a, const BivectorWeight& b) noexcept {
        const double xMx = a.x * a.x;
        const double xMy = a.x * a.y;
        const double xMz = a.x * a.z;
        const double yMy = a.y * a.y;
        const double yMz = a.y * a.z;
        const double zMz = a.z * a.z;
        return {
            .wx = (2.0 * (-b.wy * xMy - b.wz * xMz) + b.wx * (yMy + zMz - xMx)),
            .wy = (2.0 * (-b.wx * xMy - b.wz * yMz) + b.wy * (xMx + zMz - yMy)),
            .wz = (2.0 * (-b.wx * xMz - b.wy * yMz) + b.wz * (xMx + yMy - zMz))
        };
    }
    constexpr BivectorWeight PlaneIdeal::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const PlaneIdeal&a, const PseudoScalar& b) noexcept {
        return {
            .i = b.i * (-a.x * a.x - a.y * a.y - a.z * a.z)
        };
    }
    constexpr PseudoScalar PlaneIdeal::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const PlaneIdeal&a, const PointCenter& b) noexcept {
        return {
            .x = 0.0,
            .y = 0.0,
            .z = 0.0,
            .w = (a.x * a.x + a.y * a.y + a.z * a.z)
        };
    }
    constexpr ProjectivePoint PlaneIdeal::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


    [[nodiscard]] constexpr Motor sandwich(const BivectorBulk&a, const Motor& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wz * xyMyz - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (-b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz)),
            .xy = (2.0 * (b.xz * xyMxz + b.yz * xyMyz) + b.xy * (xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * xyMxz + b.yz * xzMyz) + b.xz * (xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * xyMyz + b.xz * xzMyz) + b.yz * (yzMyz - xyMxy - xzMxz)),
            .i = b.i * (xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr Motor BivectorBulk::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const BivectorBulk&a, const Plane& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (-b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz)),
            .w = b.w * (xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr Plane BivectorBulk::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const BivectorBulk&a, const Bivector& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .wx = (2.0 * (b.wz * xyMyz - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (-b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz)),
            .xy = (2.0 * (b.xz * xyMxz + b.yz * xyMyz) + b.xy * (xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * xyMxz + b.yz * xzMyz) + b.xz * (xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * xyMyz + b.xz * xzMyz) + b.yz * (yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr Bivector BivectorBulk::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const BivectorBulk&a, const ProjectivePoint& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (-b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz)),
            .w = b.w * (xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr ProjectivePoint BivectorBulk::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Quaternion sandwich(const BivectorBulk&a, const Quaternion& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (xyMxy + xzMxz + yzMyz),
            .xy = (2.0 * (b.xz * xyMxz + b.yz * xyMyz) + b.xy * (xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * xyMxz + b.yz * xzMyz) + b.xz * (xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * xyMyz + b.xz * xzMyz) + b.yz * (yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr Quaternion BivectorBulk::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const BivectorBulk&a, const ProjectiveTranslator& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = b.s * (xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wz * xyMyz - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (-b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr ProjectiveTranslator BivectorBulk::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const BivectorBulk&a, const Translator& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .s = (xyMxy + xzMxz + yzMyz),
            .wx = (2.0 * (b.wz * xyMyz - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (-b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr ProjectiveTranslator BivectorBulk::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const BivectorBulk&a, const Vector& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (-b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr Vector BivectorBulk::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const BivectorBulk&a, const Point& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (-b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz)),
            .w = (xyMxy + xzMxz + yzMyz)
        };
    }
    constexpr ProjectivePoint BivectorBulk::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PlaneIdeal sandwich(const BivectorBulk&a, const PlaneIdeal& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .x = (2.0 * (b.z * xyMyz - b.y * xzMyz) + b.x * (yzMyz - xyMxy - xzMxz)),
            .y = (2.0 * (-b.x * xzMyz - b.z * xyMxz) + b.y * (xzMxz - xyMxy - yzMyz)),
            .z = (2.0 * (b.x * xyMyz - b.y * xyMxz) + b.z * (xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr PlaneIdeal BivectorBulk::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorBulk sandwich(const BivectorBulk&a, const BivectorBulk& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .xy = (2.0 * (b.xz * xyMxz + b.yz * xyMyz) + b.xy * (xyMxy - xzMxz - yzMyz)),
            .xz = (2.0 * (b.xy * xyMxz + b.yz * xzMyz) + b.xz * (xzMxz - xyMxy - yzMyz)),
            .yz = (2.0 * (b.xy * xyMyz + b.xz * xzMyz) + b.yz * (yzMyz - xyMxy - xzMxz))
        };
    }
    constexpr BivectorBulk BivectorBulk::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const BivectorBulk&a, const BivectorWeight& b) noexcept {
        const double xyMxy = a.xy * a.xy;
        const double xyMxz = a.xy * a.xz;
        const double xyMyz = a.xy * a.yz;
        const double xzMxz = a.xz * a.xz;
        const double xzMyz = a.xz * a.yz;
        const double yzMyz = a.yz * a.yz;
        return {
            .wx = (2.0 * (b.wz * xyMyz - b.wy * xzMyz) + b.wx * (yzMyz - xyMxy - xzMxz)),
            .wy = (2.0 * (-b.wx * xzMyz - b.wz * xyMxz) + b.wy * (xzMxz - xyMxy - yzMyz)),
            .wz = (2.0 * (b.wx * xyMyz - b.wy * xyMxz) + b.wz * (xyMxy - xzMxz - yzMyz))
        };
    }
    constexpr BivectorWeight BivectorBulk::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const BivectorBulk&a, const PseudoScalar& b) noexcept {
        return {
            .i = b.i * (a.xy * a.xy + a.xz * a.xz + a.yz * a.yz)
        };
    }
    constexpr PseudoScalar BivectorBulk::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const BivectorBulk&a, const PointCenter& b) noexcept {
        return {
            .x = 0.0,
            .y = 0.0,
            .z = 0.0,
            .w = (a.xy * a.xy + a.xz * a.xz + a.yz * a.yz)
        };
    }
    constexpr ProjectivePoint BivectorBulk::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }




    [[nodiscard]] constexpr Motor sandwich(const PointCenter&a, const Motor& b) noexcept {
        return {
            .s = b.s,
            .wx = -b.wx,
            .wy = -b.wy,
            .wz = -b.wz,
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz,
            .i = -b.i
        };
    }
    constexpr Motor PointCenter::sandwich(const Motor& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Plane sandwich(const PointCenter&a, const Plane& b) noexcept {
        return {
            .x = b.x,
            .y = b.y,
            .z = b.z,
            .w = -b.w
        };
    }
    constexpr Plane PointCenter::sandwich(const Plane& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Bivector sandwich(const PointCenter&a, const Bivector& b) noexcept {
        return {
            .wx = -b.wx,
            .wy = -b.wy,
            .wz = -b.wz,
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz
        };
    }
    constexpr Bivector PointCenter::sandwich(const Bivector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectivePoint sandwich(const PointCenter&a, const ProjectivePoint& b) noexcept {
        return {
            .x = -b.x,
            .y = -b.y,
            .z = -b.z,
            .w = b.w
        };
    }
    constexpr ProjectivePoint PointCenter::sandwich(const ProjectivePoint& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Quaternion sandwich(const PointCenter&a, const Quaternion& b) noexcept {
        return {
            .s = b.s,
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz
        };
    }
    constexpr Quaternion PointCenter::sandwich(const Quaternion& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr ProjectiveTranslator sandwich(const PointCenter&a, const ProjectiveTranslator& b) noexcept {
        return {
            .s = b.s,
            .wx = -b.wx,
            .wy = -b.wy,
            .wz = -b.wz
        };
    }
    constexpr ProjectiveTranslator PointCenter::sandwich(const ProjectiveTranslator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Translator sandwich(const PointCenter&a, const Translator& b) noexcept {
        return {
            .wx = -b.wx,
            .wy = -b.wy,
            .wz = -b.wz
        };
    }
    constexpr Translator PointCenter::sandwich(const Translator& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Vector sandwich(const PointCenter&a, const Vector& b) noexcept {
        return {
            .x = -b.x,
            .y = -b.y,
            .z = -b.z
        };
    }
    constexpr Vector PointCenter::sandwich(const Vector& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr Point sandwich(const PointCenter&a, const Point& b) noexcept {
        return {
            .x = -b.x,
            .y = -b.y,
            .z = -b.z
        };
    }
    constexpr Point PointCenter::sandwich(const Point& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PlaneIdeal sandwich(const PointCenter&a, const PlaneIdeal& b) noexcept {
        return {
            .x = b.x,
            .y = b.y,
            .z = b.z
        };
    }
    constexpr PlaneIdeal PointCenter::sandwich(const PlaneIdeal& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorBulk sandwich(const PointCenter&a, const BivectorBulk& b) noexcept {
        return {
            .xy = b.xy,
            .xz = b.xz,
            .yz = b.yz
        };
    }
    constexpr BivectorBulk PointCenter::sandwich(const BivectorBulk& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr BivectorWeight sandwich(const PointCenter&a, const BivectorWeight& b) noexcept {
        return {
            .wx = -b.wx,
            .wy = -b.wy,
            .wz = -b.wz
        };
    }
    constexpr BivectorWeight PointCenter::sandwich(const BivectorWeight& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PseudoScalar sandwich(const PointCenter&a, const PseudoScalar& b) noexcept {
        return {
            .i = -b.i
        };
    }
    constexpr PseudoScalar PointCenter::sandwich(const PseudoScalar& b) const noexcept { return pga3d::sandwich(*this, b); }

    [[nodiscard]] constexpr PointCenter sandwich(const PointCenter&a, const PointCenter& b) noexcept {
        return {};
    }
    constexpr PointCenter PointCenter::sandwich(const PointCenter& b) const noexcept { return pga3d::sandwich(*this, b); }


}